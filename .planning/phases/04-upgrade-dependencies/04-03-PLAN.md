---
phase: 04-upgrade-dependencies
plan: 03
type: execute
wave: 3
depends_on: ["04-02"]
files_modified: [package.json, pnpm-lock.yaml]
autonomous: false

must_haves:
  truths:
    - "Development tooling dependencies are upgraded to their latest major versions"
    - "Build toolchain (Vite 7, related plugins) works correctly"
    - "TypeScript tooling (vue-tsc, type-helpers) functions properly"
    - "Development experience remains intact or improves"
  artifacts:
    - path: "package.json"
      provides: "Updated major versions for devDependencies"
      contains: "vite: ^7, @vitejs/plugin-vue: ^6, and other dev tool majors"
    - path: "pnpm-lock.yaml"
      provides: "Lock file with resolved major dev versions"
      min_lines: 100
  key_links:
    - from: "package.json"
      to: "vite.config.ts"
      via: "Vite 7 config compatibility"
      pattern: "defineConfig"
    - from: "@vitejs/plugin-vue"
      to: "vite"
      via: "Plugin must be compatible with Vite 7"
      pattern: "plugin-vue@6.*"
---

<objective>
Upgrade development tooling to latest major versions (Vite 7, @vitejs/plugin-vue 6, TypeScript tooling, unplugin ecosystem) to benefit from improved build performance and modern tooling features.

Purpose: Development dependencies can be upgraded more aggressively than runtime dependencies because they don't affect production code. This upgrades the build toolchain first to ensure the development environment is ready before upgrading runtime dependencies.
Output: Updated package.json with major dev dependency upgrades, verified through build and development server, with potential manual testing checkpoint for development experience validation.
</objective>

<execution_context>
@~/.config/opencode/get-shit-done/workflows/execute-plan.md
@~/.config/opencode/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/04-upgrade-dependencies/04-RESEARCH.md
@.planning/phases/04-upgrade-dependencies/04-01-SUMMARY.md
@.planning/phases/04-upgrade-dependencies/04-02-SUMMARY.md
@package.json
@vite.config.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Upgrade Vite ecosystem and build tools</name>
  <files>package.json, pnpm-lock.yaml, vite.config.ts</files>
  <action>
Upgrade Vite ecosystem first as a cohesive group:

Run `npx taze -f "vite*,@vitejs/*" major` to preview Vite-related major updates:
- vite: 6.3.5 → 7.3.1
- @vitejs/plugin-vue: 5.2.4 → 6.0.3
- vite-plugin-vue-devtools: 7.7.6 → 8.0.5

Apply the upgrades with `-w` flag:
```bash
npx taze -f "vite*,@vitejs/*" major -w
```

Run `pnpm install` to resolve dependencies. Watch for peer dependency warnings.

Check vite.config.ts for any deprecated options by reading the file. If Vite 7 migration guide mentions breaking config changes, note them (but do NOT modify config unless build fails).

Test the build:
```bash
pnpm build
```

If build fails with config errors, check Vite 7 breaking changes documentation and update vite.config.ts accordingly. Common Vite 6→7 changes may include plugin API updates or config schema changes.
  </action>
  <verify>
`npx taze -f "vite*,@vitejs/*" major -w` modifies package.json.
`pnpm install` completes (warnings acceptable).
`pnpm build` succeeds or fails with clear config error message.
If config needs updating, vite.config.ts is modified and build succeeds.
  </verify>
  <done>
Vite ecosystem upgraded to major versions.
Production build succeeds with Vite 7.
vite.config.ts is compatible with Vite 7 (updated if necessary).
  </done>
</task>

<task type="auto">
  <name>Task 2: Upgrade TypeScript tooling and unplugin ecosystem</name>
  <files>package.json, pnpm-lock.yaml</files>
  <action>
Upgrade TypeScript-related tooling:
- typescript: ~5.8.0 → ~5.9.3
- vue-tsc: 2.2.10 → 3.2.4
- vue-component-type-helpers: 2.2.10 → 3.2.4

Upgrade unplugin ecosystem:
- unplugin-auto-import: 19.3.0 → 21.0.0
- unplugin-vue-components: 28.7.0 → 31.0.0

Use taze to apply these together:
```bash
npx taze -f "typescript,vue-tsc,vue-component-type-helpers,unplugin-*" major -w
pnpm install
```

Test TypeScript compilation:
```bash
pnpm type-check
```

If type-check fails, check for breaking changes in vue-tsc 3.x or vue-component-type-helpers 3.x. These tools should be backward compatible, but may expose previously hidden type errors.

Test linting (eslint uses typescript-eslint under the hood):
```bash
pnpm lint
```
  </action>
  <verify>
Package.json shows upgraded versions for TypeScript tooling and unplugin packages.
`pnpm install` completes successfully.
`pnpm type-check` passes without errors.
`pnpm lint` passes without errors.
  </verify>
  <done>
TypeScript tooling upgraded to latest major versions.
Unplugin ecosystem upgraded to latest major versions.
Type checking and linting pass successfully.
  </done>
</task>

<task type="auto">
  <name>Task 3: Upgrade remaining devDependencies and test</name>
  <files>package.json, pnpm-lock.yaml</files>
  <action>
Upgrade remaining devDependencies with major updates:
- @deviltea/eslint-config: 4.0.0 → 6.0.1
- @deviltea/tsconfig: 0.0.7 → 0.0.8
- @types/node: 22.19.7 → 25.1.0 (already at 22.19.7 from 04-02, now jump to 25)
- lint-staged: 15.5.2 → 16.2.7
- @pikacss/plugin-icons: 0.0.29 → 0.0.39
- @pikacss/vite-plugin-pikacss: 0.0.29 → 0.0.39

Apply upgrades:
```bash
npx taze -f "@deviltea/*,@types/node,lint-staged,@pikacss/*" major -w
pnpm install
```

Run full verification suite:
```bash
pnpm type-check
pnpm lint
pnpm build
```

All three commands must pass. If @deviltea/eslint-config 6.x introduces new lint rules, they may cause lint failures. Review the failures:
- If they're valid improvements, fix them (simple issues only, like formatting)
- If they're complex, document and consider adding eslint disable comments with justification
  </action>
  <verify>
All remaining devDependencies are upgraded.
`pnpm type-check` passes.
`pnpm lint` passes (with fixes applied if needed).
`pnpm build` produces successful dist/ output.
  </verify>
  <done>
All devDependencies upgraded to latest major versions.
Full verification suite passes.
Any new lint rules are addressed or documented.
  </done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Complete development tooling upgrade to major versions:
- Vite 6 → 7 with @vitejs/plugin-vue 5 → 6
- TypeScript tooling: vue-tsc 2 → 3, typescript ~5.8 → ~5.9
- Unplugin ecosystem: major version jumps
- PikaCSS, lint-staged, and other dev tools
  </what-built>
  <how-to-verify>
1. Start development server:
   ```bash
   pnpm dev
   ```
   Visit http://localhost:5173 (or the URL shown)

2. Verify development experience:
   - [ ] Hot module replacement (HMR) works when editing a .vue file
   - [ ] Vue DevTools browser extension detects the app (if installed)
   - [ ] No console errors in browser
   - [ ] vite-plugin-vue-devtools overlay appears (press Alt+Shift+D or check bottom-left corner)

3. Test filter feature from Phase 1/2:
   - [ ] Navigate to a playlist
   - [ ] Click filter toggle button (funnel icon)
   - [ ] Select some marks - checkboxes work correctly
   - [ ] Filtered tracks display correctly

4. Build verification:
   - [ ] `pnpm build` output looks normal (no suspicious warnings)
   - [ ] Preview build: `pnpm preview` and test in browser

5. Type-check and lint:
   - [ ] Run `pnpm type-check` - no errors
   - [ ] Run `pnpm lint` - no errors

If anything fails or behaves incorrectly, describe the issue in detail.
  </how-to-verify>
  <resume-signal>Type "approved" if all checks pass, or describe any issues found</resume-signal>
</task>

<task type="auto">
  <name>Task 4: Commit development tooling upgrades</name>
  <files>package.json, pnpm-lock.yaml, vite.config.ts</files>
  <action>
Commit all development tooling upgrades with detailed message:

```bash
git add package.json pnpm-lock.yaml vite.config.ts
git commit -m "chore(deps): upgrade development tooling to major versions

Build toolchain:
- vite: 6.3.5 → 7.3.1
- @vitejs/plugin-vue: 5.2.4 → 6.0.3
- vite-plugin-vue-devtools: 7.7.6 → 8.0.5

TypeScript tooling:
- typescript: ~5.8.0 → ~5.9.3
- vue-tsc: 2.2.10 → 3.2.4
- vue-component-type-helpers: 2.2.10 → 3.2.4

Unplugin ecosystem:
- unplugin-auto-import: 19.3.0 → 21.0.0
- unplugin-vue-components: 28.7.0 → 31.0.0

Other devDependencies:
- @deviltea/eslint-config: 4.0.0 → 6.0.1
- @deviltea/tsconfig: 0.0.7 → 0.0.8
- @types/node: 22.19.7 → 25.1.0
- lint-staged: 15.5.2 → 16.2.7
- @pikacss/plugin-icons: 0.0.29 → 0.0.39
- @pikacss/vite-plugin-pikacss: 0.0.29 → 0.0.39

Verified through build, type-check, lint, dev server, and manual testing."
```

If vite.config.ts was modified, include in commit message: "Updated vite.config.ts for Vite 7 compatibility".
  </action>
  <verify>
Git commit is created.
`git log -1` shows the detailed commit message.
`git diff HEAD~1` shows package.json, pnpm-lock.yaml, and optionally vite.config.ts.
  </verify>
  <done>
Development tooling upgrades committed to git.
Commit message documents all major version changes.
  </done>
</task>

</tasks>

<verification>
1. Run `pnpm outdated` - devDependencies with major updates should be gone or only runtime deps remain
2. Full development workflow: `pnpm dev` and test HMR, Vue DevTools, filter feature
3. Build and preview: `pnpm build && pnpm preview` - production build works
4. Git log shows commit with all dev tooling upgrades
</verification>

<success_criteria>
- [ ] Vite 7 and @vitejs/plugin-vue 6 successfully integrated
- [ ] TypeScript tooling (vue-tsc 3, typescript 5.9) works correctly
- [ ] Unplugin ecosystem upgraded without breaking auto-imports or component resolution
- [ ] Development server starts and HMR functions properly
- [ ] All verification commands pass (build, type-check, lint, dev)
- [ ] Manual testing confirms feature functionality intact
- [ ] Git history contains clean commit documenting dev tooling upgrades
</success_criteria>

<output>
After completion, create `.planning/phases/04-upgrade-dependencies/04-03-SUMMARY.md`
</output>
